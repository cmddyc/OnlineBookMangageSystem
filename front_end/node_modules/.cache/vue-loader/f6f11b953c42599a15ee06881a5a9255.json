{"remainingRequest":"D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\src\\views\\user\\BorrowBook.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\src\\views\\user\\BorrowBook.vue","mtime":1672321283893},{"path":"D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1669884633585},{"path":"D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\node_modules\\babel-loader\\lib\\index.js","mtime":1669884625099},{"path":"D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1669884633585},{"path":"D:\\Spirited\\G3\\软件工程\\BookManage-1.0.0\\front_end\\node_modules\\vue-loader\\lib\\index.js","mtime":1669884623589}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgbWFwU3RhdGUsCiAgbWFwTXV0YXRpb25zLAogIG1hcEdldHRlcnMsCiAgbWFwQWN0aW9ucwp9IGZyb20gJ3Z1ZXgnCmV4cG9ydCBkZWZhdWx0IHsKICBpbmplY3Q6IFsncmVsb2FkJ10sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJvb2tOYW1lOiAnJywKICAgICAgYm9va0xpc3Q6IFtdLAogICAgICBpc0ZpbmQ6IGZhbHNlLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICBmb3JtVGl0bGU6ICdURVNUJywKICAgICAgZm9ybVZpc2libGU6IGZhbHNlCiAgICB9CiAgfSwKICBjb21wdXRlZDp7CiAgICAuLi5tYXBTdGF0ZSgndXNlckFib3V0JywgWydpZCddKQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZmluZEJvb2soKSB7CiAgICAgIC8vIGlmICh0aGlzLmJvb2tOYW1lLnRyaW0oKS5sZW5ndGggPT09IDApIHsKICAgICAgLy8gICByZXR1cm4gdGhpcy4kbWVzc2FnZS5pbmZvKHsKICAgICAgLy8gICAgIG1lc3NhZ2U6ICfor7fovpPlhaXkvaDopoHmn6Xor6LnmoTlm77kuaYnLAogICAgICAvLyAgICAgZHVyYXRpb246IDE1MDAKICAgICAgLy8gICB9KQogICAgICAvLyB9CiAgICAgIGxldCBzdWJtaXQgPSB0aGlzLmJvb2tOYW1lCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KHRoaXMuYmFzZVVybCtgL2ZpbmRCb29rP25hbWU9JHtzdWJtaXR9YCkKICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLmlzRmluZCA9IGZhbHNlCiAgICAgIH0KICAgICAgdGhpcy5pc0ZpbmQgPSB0cnVlCiAgICAgIHRoaXMuYm9va0xpc3QgPSByZXMuZGF0YQogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgfSwKICAgIHNob3d3KHJvdykgewogICAgICB0aGlzLmZvcm1UaXRsZSA9IHJvdy5ib29rX25hbWUKICAgICAgdGhpcy5mb3JtVmlzaWJsZSA9IHRydWUgICAgICAgCiAgICB9LAogICAgYXN5bmMgc2hvd0Jvb2tJbmZvKHJvdykgewogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLmdldCh0aGlzLmJhc2VVcmwrYC9nZXRCb29rSW5mbz9ib29rX2lkPSR7cm93LmJvb2tfaWR9YCkKICAgICAgaWYgKHJlcy5kYXRhLmJvb2tfaW5mbyA9PT0gbnVsbCB8fCByZXMuZGF0YS5ib29rX2luZm8udHJpbSgpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJlcy5kYXRhLmJvb2tfaW5mbyA9ICfmmoLml6Dor6bmg4Xkv6Hmga8nCiAgICAgIH0KICAgICAgdGhpcy4kYWxlcnQoYCR7cmVzLmRhdGEuYm9va19pbmZvfWAsICfkuabmnKzor6bmg4XvvIjljIXlkKvlm77niYfjgIHlrprku7fjgIHmmK/lkKbnlLXlrZDkuabvvIknKQogICAgfSwKICAgIGFzeW5jIGJvcnJvd0Jvb2socm93KSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oYOehruWumuimgeWAn+mYhei/meacrCAke3Jvdy5hdXRob3J9IOeahCAke3Jvdy5ib29rX25hbWV9IOWQl++8n2AsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICdpbmZvJwogICAgICB9KS50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICBsZXQgc3VibWl0ID0gewogICAgICAgICAgYm9va19pZDogcm93LmJvb2tfaWQsCiAgICAgICAgICBpZDp0aGlzLmlkCiAgICAgICAgfQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCh0aGlzLmJhc2VVcmwrYC9zdWJtaXRCb3Jyb3dSZXFgLCBzdWJtaXQpCiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHsKICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+axguaPkOS6pOaIkOWKnycsCiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwCiAgICAgICAgICB9KQogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLnJlbG9hZCgpCiAgICAgICAgfSwgNTAwKQogICAgICAgICAgcmV0dXJuIAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fmsYLlpLHotKUs6K+356iN5ZCO5YaN6K+VJywKICAgICAgICAgICAgZHVyYXRpb246IDEwMDAKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKHsKICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtognLAogICAgICAgICAgZHVyYXRpb246IDEwMDAKICAgICAgICB9KQogICAgICB9KQoKICAgIH0KICB9Cn0K"},{"version":3,"sources":["BorrowBook.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"BorrowBook.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"text-align:center;\"><span class=\"gray-title\">在线图书系统</span></div>\r\n    <!-- 用户查询区 -->\r\n    <el-row :gutter=\"15\" style=\"margin:2rem 2rem 0 2rem\">\r\n      <el-col :span=\"21\">\r\n        <el-input @keydown.enter.native=\"findBook\" placeholder=\"请输入查询的图书\" prefix-icon=\"el-icon-search\"\r\n          v-model=\"bookName\">\r\n        </el-input>\r\n      </el-col>\r\n      <el-col :span=\"3\">\r\n        <el-button plain @click=\"findBook\">点我查询</el-button>\r\n      </el-col>\r\n    </el-row>\r\n    <!-- 空状态显示区 -->\r\n    <el-empty v-if=\"!isFind\" :image-size=\"200\" style=\"margin-top: 2rem;user-select:none;\"></el-empty>\r\n    <!-- 结果显示区 -->\r\n    <el-table class=\"book-table\" :data=\"bookList\" v-if=\"isFind\" border stripe v-loading=\"loading\" style=\"width: 100%;\">\r\n      <el-table-column type=\"index\" label=\"#\"></el-table-column>\r\n      <el-table-column label=\"缩略图\" align=\"center\" width=\"150\">\r\n                <!-- style=\"height:100px;width=30%\" :fit=\"fit\" -->\r\n                <template v-slot:default=\"scope\">\r\n                    <!-- <img :src=\"scope.row.book_img\" width=\"120\" height=\"138\" /> -->\r\n                    <el-image style=\"width: 120px; height: 138px\" :src=\"require('../../assets/book/02.jpg')\" :fit=\"fit\" />\r\n                </template>\r\n            </el-table-column>\r\n      <el-table-column label=\"书名\" prop=\"book_name\"></el-table-column>\r\n      <el-table-column label=\"作者\" prop=\"author\"></el-table-column>\r\n      \r\n      <el-table-column label=\"操作\">\r\n        <template slot-scope=\"scope\">\r\n          <div class=\"user-ctrl\">\r\n            <el-link type=\"primary\" @click=\"showBookInfo(scope.row)\">查看详情</el-link>\r\n            <el-link type=\"primary\" @click=\"showw(scope.row)\">借阅</el-link>\r\n            <el-link type=\"primary\" @click=\"borrowBook(scope.row)\">预订</el-link>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-dialog :title=formTitle :visible.sync=\"formVisible\" width=\"60%\">\r\n      <el-descriptions title=\"XX图书\" :column=\"1\">\r\n        <el-descriptions-item label=\"定价\">36</el-descriptions-item>\r\n        <el-descriptions-item label=\"电子书\">是</el-descriptions-item>\r\n        <el-descriptions-item label=\"描述\">苏州市江苏省苏州市吴中区吴中大道江苏省苏州市吴中区吴中大道江苏省苏州市吴中区吴中大道江苏省苏州市吴中区吴中大道江苏省苏州市吴中区吴中大道</el-descriptions-item>\r\n        \r\n      </el-descriptions>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    mapState,\r\n    mapMutations,\r\n    mapGetters,\r\n    mapActions\r\n  } from 'vuex'\r\n  export default {\r\n    inject: ['reload'],\r\n    data() {\r\n      return {\r\n        bookName: '',\r\n        bookList: [],\r\n        isFind: false,\r\n        loading: true,\r\n        formTitle: 'TEST',\r\n        formVisible: false\r\n      }\r\n    },\r\n    computed:{\r\n      ...mapState('userAbout', ['id'])\r\n    },\r\n    methods: {\r\n      async findBook() {\r\n        // if (this.bookName.trim().length === 0) {\r\n        //   return this.$message.info({\r\n        //     message: '请输入你要查询的图书',\r\n        //     duration: 1500\r\n        //   })\r\n        // }\r\n        let submit = this.bookName\r\n        const res = await this.$http.get(this.baseUrl+`/findBook?name=${submit}`)\r\n        if (res.data.length === 0) {\r\n          return this.isFind = false\r\n        }\r\n        this.isFind = true\r\n        this.bookList = res.data\r\n        this.loading = false\r\n      },\r\n      showw(row) {\r\n        this.formTitle = row.book_name\r\n        this.formVisible = true       \r\n      },\r\n      async showBookInfo(row) {\r\n        const res = await this.$http.get(this.baseUrl+`/getBookInfo?book_id=${row.book_id}`)\r\n        if (res.data.book_info === null || res.data.book_info.trim().length === 0) {\r\n          res.data.book_info = '暂无详情信息'\r\n        }\r\n        this.$alert(`${res.data.book_info}`, '书本详情（包含图片、定价、是否电子书）')\r\n      },\r\n      async borrowBook(row) {\r\n        this.$confirm(`确定要借阅这本 ${row.author} 的 ${row.book_name} 吗？`, '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'info'\r\n        }).then(async () => {\r\n          let submit = {\r\n            book_id: row.book_id,\r\n            id:this.id\r\n          }\r\n          const res = await this.$http.post(this.baseUrl+`/submitBorrowReq`, submit)\r\n          if (res.status === 200) {\r\n            this.$message.success({\r\n              message: '请求提交成功',\r\n              duration: 1000\r\n            })\r\n            setTimeout(() => {\r\n            this.reload()\r\n          }, 500)\r\n            return \r\n          } else {\r\n            return this.$message.error({\r\n              message: '请求失败,请稍后再试',\r\n              duration: 1000\r\n            })\r\n          }\r\n        }).catch(() => {\r\n          this.$message.info({\r\n            message: '已取消',\r\n            duration: 1000\r\n          })\r\n        })\r\n\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .gray-title {\r\n    position: relative;\r\n    user-select: none;\r\n    color: darkgray;\r\n    text-shadow: 5px 5px 5px gray;\r\n    font-size: 2rem;\r\n    padding: 1rem 0 1rem 0;\r\n    line-height: 4rem;\r\n  }\r\n\r\n  .book-table {\r\n    margin-top: 2rem;\r\n    border-radius: 0.5rem;\r\n  }\r\n\r\n  .user-ctrl {\r\n    display: flex;\r\n    justify-content: space-around;\r\n  }\r\n</style>"]}]}